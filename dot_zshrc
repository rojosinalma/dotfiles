# Init Prezto
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi

# When using zsh-autocompletion
# source ~/.zprezto/contrib/zsh-autocomplete/zsh-autocomplete.plugin.zsh

# GENERAL CONFIG AND PATH
# (For other env vars and dirs, check zshenv)
#------------------

# HOMEBREW INSTALLED
if [ -d "/opt/homebrew" ]; then
  eval "$(/opt/homebrew/bin/brew shellenv)"

  # Autojump
  [[ -s $(brew --prefix)/etc/profile.d/autojump.sh ]] && . $(brew --prefix)/etc/profile.d/autojump.sh

  # asdf-vm
  # . $(brew --prefix asdf)/libexec/asdf.sh
  # . /opt/homebrew/opt/asdf/libexec/asdf.sh

  # smerge
  export PATH="$PATH:/Applications/Sublime Text.app/Contents/SharedSupport/bin:/Applications/Sublime Merge.app/Contents/SharedSupport/bin"

  # Completions for brew
  fpath=($(brew --prefix)/share/zsh/site-functions $fpath) # Homebrew zsh completions

  # iTerm Shell Integration
  test -e ${HOME}/.iterm2_shell_integration.zsh && source ${HOME}/.iterm2_shell_integration.zsh
fi

# LINUX INSTALLED
if [ -d "/home/rojo" ]; then
  . /home/rojo/.asdf/asdf.sh
  export PATH="$PATH:/usr/local/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Users/rojo/.asdf/installs/python/3.10.5/bin"

fi

# PATH
#------------------

# Rust
if [ -d "/Users/rojo/.asdf/installs/rust" ]; then
  source "/Users/rojo/.asdf/installs/rust/1.70.0/env"
fi

## Exo
if [ -d "/Users/rojo/.exo" ]; then
  export PATH=$PATH:/Users/rojo/.exo/bin
fi

## Mysql-client
if [ -d "/opt/homebrew/opt/mysql-client" ]; then
  export PATH="/opt/homebrew/opt/mysql-client/bin:$PATH"
fi

# COMPLETIONS
#------------------

# FPATH
fpath=("~/.fpath" $fpath)
fpath=(${ASDF_DIR}/completions $fpath)

# GH CLI completion
if command -v gh > /dev/null 2>&1; then
  eval $(gh completion -s zsh)
fi

# colorls
if command -v colorls > /dev/null 2>&1; then
  source $(dirname $(gem which colorls))/tab_complete.sh
fi

## Bitwarden
if command -v bw > /dev/null 2>&1; then
  eval $(bw completion --shell zsh)
fi

# # AWS CLI completion
# complete -C '/opt/homebrew/bin/aws_completer' aws

# # Kustomize completion
# eval $(kustomize completion zsh)

# # eksctl completion
# eval $(eksctl completion zsh)

# # Kitty
# kitty + complete setup zsh | source /dev/stdin

# fff cd on exit
# f() {
#     fff "$@"
#     cd "$(cat "${XDG_CACHE_HOME:=${HOME}/.cache}/fff/.fff_d")"
# }

# mcfly
# if [[ -r "/usr/local/opt/mcfly/mcfly.zsh" ]]; then
#   source "/usr/local/opt/mcfly/mcfly.zsh"
# fi

# PERSONAL EXTRAS
#------------------
source ~/.zsh_opts
source ~/.zsh_env
source ~/.zsh_functions
source ~/.zsh_aliases
source ~/.zsh_secrets

# Init completions
autoload -U +X bashcompinit && bashcompinit
autoload -Uz compinit && compinit

## General ZSH
zstyle ':completion:*:*:kill:*' menu yes select
zstyle ':completion:*:kill:*'   force-list always
zstyle ':completion:*:cd:*'     ignore-parents parent pwd
