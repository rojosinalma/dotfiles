# Binds (https://stackoverflow.com/questions/6205157/iterm-2-how-to-set-keyboard-shortcuts-to-jump-to-beginning-end-of-line#10485061)
#-------------------

bindkey -e
bindkey '^[[1;9C' forward-word
bindkey '^[[1;9D' backward-word

# Core Setup (builtins, zsh, etc)
#-------------------

# Builtins
alias c="clear"
alias l="ls -la"
alias lsd="ls -d */"
alias motd="sudo run-parts /etc/update-motd.d"

# EZA for colorful ls
if command -v eza > /dev/null 2>&1; then
  alias ls="eza --icons -1 --group-directories-first -g --git --git-repos -o"
fi

# Remap dirs (used to override prezto module)
alias d='dirs -v'
for index ({1..11}) alias "$index"="cd -${index}"; unset index

# Custom Setup (my aliases)
#--------------------

## TOOLS ALIASES
alias kc="kubectl"
alias cf="cloudflared"
alias tf="terraform"
alias lg="lazygit"

# Utils
alias agrep="alias | grep" # Find some pattern in my aliases
alias zshsource="source $HOME/.zshrc && source $HOME/.zpreztorc" # Source configs
alias hostconf="sudo $EDITOR /etc/hosts"

# NVIM
alias vim="$(asdf which nvim)"
alias nvimconfig="nvim ~/.config/nvim"

# Chezmoi edits
alias cm="$(asdf which chezmoi)"
alias zshaliases="cm edit --apply $HOME/.zsh_aliases"
alias zshenv="cm edit --apply $HOME/.zsh_env"
alias zshopts="cm edit --apply $HOME/.zsh_opts"
alias zshconfig="cm edit --apply $HOME/.zshrc"
alias zshfunctions="cm edit --apply $HOME/.zsh_functions"
alias prezconfig="cm edit --apply $HOME/.zpreztorc"
alias promptedit="cm edit --apply $HOME/.zprezto/contrib/rojo-prompt/prompt_rojo_setup"
alias gitconfig="cm edit --apply $HOME/.gitconfig"
alias zsecrets="cm edit --apply $HOME/.zsh_secrets"
alias sshconfig="cm edit --apply $HOME/.ssh/"
alias tmuxconfig="cm edit --apply $HOME/.tmux.conf"

# GH CLI Utils (keep requests every 5 seconds to avoid getting rate limited)
alias ghwci='watch -n 5 '\''gh run list --limit 5 --json status,conclusion,workflowDatabaseId,displayTitle -q ".[] | \"\(.displayTitle): \(.status) / \(.conclusion)\""'\'''
alias ghdr='gh api repos/$1/actions/runs | jq -r ".workflow_runs[] | select(.head_branch != \"docker\") | \"(.id)\"" | xargs -n1 -J % gh api repos/$1/actions/runs/% -X DELETE'

# Ruby/Rails
# alias rs="rails server"
# alias rc="rails console"
# alias bc="bin/console"
# alias be="bundle exec"
# alias gemconfig="$EDITOR $HOME/.rvm/gemsets/global.gems"
# alias rspuma="RAILS_ENV=development bundle exec rails s Puma -p 8080"
# alias dbreset="rake db:migrate:reset && rake db:reset"
# alias mtest="ruby -r minitest/pride *_test.rb"

# Docker
alias dimg="docker images" # Show docker images.
alias drmi='docker rmi $(docker images -q)' # Remove all images.
alias dpsa='docker ps -a --format "table {{.ID}}\t{{.Names}}\t{{.Status}}\t{{.Networks}}\t{{.Image}}"' # Show running docker containers.
alias dpsap='docker ps -a --format "table {{.ID}}\t{{.Names}}\t{{.Networks}}\t{{.Ports}}"' # Show containers with ports
alias dpsaq="docker ps -aq" # Show running docker containers without Header (used for other aliases).
alias dstop='docker stop $(dpsaq)' # Stop all running containers.
alias drma='docker rm $(dpsaq)' # Remove all running containers.
alias dclean="docker images -qf dangling=true | xargs docker rmi" # Remove all dangling images.
alias dprune="docker system prune -a" # Delete unused or dangling images, containers, volumes and networks
alias dfind='docker images -a | grep $1' # List images that match pattern.
alias dfindrm='docker images -a | grep $1 | awk "{print $3}" | xargs docker rmi' # Remove images that match pattern.
alias dex="docker ps -a -f status=exited" # List exited containers.
alias dexrm='docker rm $(docker ps -a -f status=exited -q)' # Stop exited containers.
alias drmf='docker stop $(dpsaq) && docker rm $(dpsaq)' # Stop and Remove all containers
alias dc="docker compose"

# Skaffold
#alias ska='skaffold'

# GCP
# alias gc='gcloud'
# alias gcl='gcloud config configurations list'
# alias gca='gcloud config configurations activate'
# alias gcpl='gcloud projects list'

# Makefile
# alias mkt="make test"
# alias mktb="make test-build"
# alias mktd="make test-down"
# alias mktp="make test-prompt"
# alias mkd="make dev"
# alias mkdd="make dev-down"
# alias mks="make status"
