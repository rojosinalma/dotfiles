#
# Simple prompt theme
#
# Authors: Rojo <rojo@rojo.dev>
#
# Screenshots:
# None
#

function prompt_rojo_pwd() {
  echo $(pwd | sed -e "s,^$HOME,~,")
}

function prompt_rojo_precmd() {
  # Build the base prompt
  local base_prompt="%F{blue}%n%F{blue}@%F{blue}%m: %F{yellow}$(prompt_rojo_pwd)"

  # Initialize prefix and suffix variables
  local prefix=""
  local suffix=""

  # Add chezmoi prefix if in subshell
  if [[ "$CHEZMOI_SUBSHELL" == "1" ]]; then
    prefix="${prefix}%F{cyan}(chezmoi) "
  fi

  # Add git-radar suffix if available
  if command -v git-radar > /dev/null 2>&1; then
    suffix="${suffix}$(git-radar --zsh --fetch)"
  fi

  # Combine and print the final prompt
  print -rP "${prefix}${base_prompt}${suffix}"
}

function prompt_rojo_setup {
  setopt LOCAL_OPTIONS
  setopt PROMPT_SUBST
  unsetopt XTRACE KSH_ARRAYS
  prompt_opts=(cr percent subst)

  # Load required functions.
  autoload -Uz add-zsh-hook

  # Add hook for calling git-info before each command.
  add-zsh-hook precmd prompt_rojo_precmd

  PROMPT='%F{green} âžœ '

  RPROMPT=''
}

prompt_rojo_setup "$@"
